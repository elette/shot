<?xml version="1.0" encoding="UTF-8"?>
<QUERY>
  <item>
    <time>2016-06-10 17:15:09</time>
    <sql><![CDATA[SELECT A.QUERYTAG,
	C.STREAM_ID, C.SOURCE_ID, C.TARGET_ID, C.OBJECT_SCHEMA, C.TARGET_TYPE,
	C.OBJECT_NAME, C.COLUMN_NAMES, C.COLUMN_COUNT,
	BS.OPERATOR_ID, BS.OPERATOR_TYPE AS SRC_OPERATOR_TYPE,
	BT.OPERATOR_TYPE AS TGT_OPETATOR_TYPE,
	A.TOTAL_COST,
	BS.TOTAL_COST AS OPERATOR_TOTAL_COST,
	BS.IO_COST,
	BS.CPU_COST,
	BS.BUFFERS   
FROM	(
	SELECT
		EXPLAIN_REQUESTER,
		SOURCE_NAME,
		EXPLAIN_TIME,
		STMTNO,
		SECTNO,
		QUERYTAG,
		TRUNC(TOTAL_COST) AS TOTAL_COST
	FROM EXPLAIN_STATEMENT 
	WHERE QUERYTAG = 'TEST01' 
		AND EXPLAIN_LEVEL = 'P'
		AND EXPLAIN_TIME = (SELECT MAX(EXPLAIN_TIME) FROM EXPLAIN_STATEMENT WHERE QUERYTAG = 'TEST01')
	) A
	JOIN (
	SELECT
		EXPLAIN_REQUESTER,
		SOURCE_NAME,
		EXPLAIN_TIME,
		STMTNO,
		SECTNO,
		STREAM_ID,
		SOURCE_TYPE,
		SOURCE_ID,
		TARGET_TYPE,
		TARGET_ID,
		OBJECT_NAME,
		OBJECT_SCHEMA,
		SUBSTR(COLUMN_NAMES,1,100) AS COLUMN_NAMES,
		COLUMN_COUNT
	FROM EXPLAIN_STREAM 
	) C
	ON C.EXPLAIN_REQUESTER = A.EXPLAIN_REQUESTER
	AND C.SOURCE_NAME = A.SOURCE_NAME
	AND C.EXPLAIN_TIME = A.EXPLAIN_TIME
	AND C.STMTNO = A.STMTNO
	AND C.SECTNO = A.SECTNO
	
	LEFT OUTER JOIN (
	
	SELECT 
		EXPLAIN_REQUESTER,
		SOURCE_NAME,
		EXPLAIN_TIME,
		STMTNO,
		SECTNO,
		OPERATOR_ID,
		OPERATOR_TYPE,
		TOTAL_COST,
		CPU_COST, IO_COST, BUFFERS		
	FROM EXPLAIN_OPERATOR 
	) BS
	ON C.EXPLAIN_REQUESTER = BS.EXPLAIN_REQUESTER
	AND C.SOURCE_NAME = BS.SOURCE_NAME
	AND C.EXPLAIN_TIME = BS.EXPLAIN_TIME
	AND C.STMTNO = BS.STMTNO
	AND C.SECTNO = BS.SECTNO
	AND C.SOURCE_ID = BS.OPERATOR_ID
	
	LEFT OUTER JOIN (
	
	SELECT 
		EXPLAIN_REQUESTER,
		SOURCE_NAME,
		EXPLAIN_TIME,
		STMTNO,
		SECTNO,
		OPERATOR_ID,
		OPERATOR_TYPE,
		TOTAL_COST
	FROM EXPLAIN_OPERATOR 
	) BT
	ON C.EXPLAIN_REQUESTER = BS.EXPLAIN_REQUESTER
	AND C.SOURCE_NAME = BS.SOURCE_NAME
	AND C.EXPLAIN_TIME = BS.EXPLAIN_TIME
	AND C.STMTNO = BS.STMTNO
	AND C.SECTNO = BS.SECTNO
	AND C.TARGET_ID = BS.OPERATOR_ID]]></sql>
  </item>
  <item>
    <time>2016-06-10 17:49:18</time>
    <sql><![CDATA[SELECT A.QUERYTAG,
	C.STREAM_ID, C.SOURCE_ID, C.TARGET_ID, C.OBJECT_SCHEMA, C.TARGET_TYPE,
	C.OBJECT_NAME, C.COLUMN_NAMES, C.COLUMN_COUNT,
	BS.OPERATOR_ID, BS.OPERATOR_TYPE AS SRC_OPERATOR_TYPE,
	BT.OPERATOR_TYPE AS TGT_OPETATOR_TYPE,
	A.TOTAL_COST,
	BS.TOTAL_COST AS OPERATOR_TOTAL_COST,
	BS.IO_COST,
	BS.CPU_COST,
	BS.BUFFERS   
FROM	(
	SELECT
		EXPLAIN_REQUESTER,
		SOURCE_NAME,
		EXPLAIN_TIME,
		STMTNO,
		SECTNO,
		QUERYTAG,
		TRUNC(TOTAL_COST) AS TOTAL_COST
	FROM EXPLAIN_STATEMENT 
	WHERE QUERYTAG = 'TEST01' 
		AND EXPLAIN_LEVEL = 'P'
		AND EXPLAIN_TIME = (SELECT MAX(EXPLAIN_TIME) FROM EXPLAIN_STATEMENT )
	) A
	JOIN (
	SELECT
		EXPLAIN_REQUESTER,
		SOURCE_NAME,
		EXPLAIN_TIME,
		STMTNO,
		SECTNO,
		STREAM_ID,
		SOURCE_TYPE,
		SOURCE_ID,
		TARGET_TYPE,
		TARGET_ID,
		OBJECT_NAME,
		OBJECT_SCHEMA,
		SUBSTR(COLUMN_NAMES,1,100) AS COLUMN_NAMES,
		COLUMN_COUNT
	FROM EXPLAIN_STREAM 
	) C
	ON C.EXPLAIN_REQUESTER = A.EXPLAIN_REQUESTER
	AND C.SOURCE_NAME = A.SOURCE_NAME
	AND C.EXPLAIN_TIME = A.EXPLAIN_TIME
	AND C.STMTNO = A.STMTNO
	AND C.SECTNO = A.SECTNO
	
	LEFT OUTER JOIN (
	
	SELECT 
		EXPLAIN_REQUESTER,
		SOURCE_NAME,
		EXPLAIN_TIME,
		STMTNO,
		SECTNO,
		OPERATOR_ID,
		OPERATOR_TYPE,
		TOTAL_COST,
		CPU_COST, IO_COST, BUFFERS		
	FROM EXPLAIN_OPERATOR 
	) BS
	ON C.EXPLAIN_REQUESTER = BS.EXPLAIN_REQUESTER
	AND C.SOURCE_NAME = BS.SOURCE_NAME
	AND C.EXPLAIN_TIME = BS.EXPLAIN_TIME
	AND C.STMTNO = BS.STMTNO
	AND C.SECTNO = BS.SECTNO
	AND C.SOURCE_ID = BS.OPERATOR_ID
	
	LEFT OUTER JOIN (
	
	SELECT 
		EXPLAIN_REQUESTER,
		SOURCE_NAME,
		EXPLAIN_TIME,
		STMTNO,
		SECTNO,
		OPERATOR_ID,
		OPERATOR_TYPE,
		TOTAL_COST
	FROM EXPLAIN_OPERATOR 
	) BT
	ON C.EXPLAIN_REQUESTER = BS.EXPLAIN_REQUESTER
	AND C.SOURCE_NAME = BS.SOURCE_NAME
	AND C.EXPLAIN_TIME = BS.EXPLAIN_TIME
	AND C.STMTNO = BS.STMTNO
	AND C.SECTNO = BS.SECTNO
	AND C.TARGET_ID = BS.OPERATOR_ID]]></sql>
  </item>
</QUERY>

